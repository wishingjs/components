"use strict";(self.webpackChunk_wishingjs_components=self.webpackChunk_wishingjs_components||[]).push([[324],{10324:function(Ge,ae,p){p.r(ae),p.d(ae,{PopupWindow:function(){return Re},StepTabs:function(){return Le},Submitter:function(){return U},default:function(){return He},getAllValues:function(){return ze},usePopup:function(){return Q},useStepTab:function(){return de}});var xe=p(15009),V=p.n(xe),Pe=p(99289),L=p.n(Pe),ge=p(5574),M=p.n(ge),le=p(71577),oe=p(26713),l=p(67294),se=(0,l.createContext)({visible:!1,open:function(){},close:function(){}});function Q(){return(0,l.useContext)(se)}var ue=(0,l.createContext)({values:{}});function de(){return(0,l.useContext)(ue)}var d=p(85893),Se=(0,l.forwardRef)(function(n,m){var y=n.onCancel,T=n.render,s=n.onBefore,j=n.onFinish,F=n.onFinishFailed,i=n.onFinished,a=n.form,C=n.confirmText,P=C===void 0?"\u786E\u5B9A":C,e=n.cancelText,h=e===void 0?"\u53D6\u6D88":e,u=n.insideStepTabs,E=n.style,W=(0,l.useState)(!1),Z=M()(W,2),O=Z[0],c=Z[1],v=Q(),$=de();(0,l.useEffect)(function(){v!=null&&v.visible&&(v!=null&&v.initialValues?a==null||a.setFieldsValue(v==null?void 0:v.initialValues):a==null||a.resetFields())},[v]);var A=function(){y?y==null||y():v==null||v.close()},I=function(){var N=L()(V()().mark(function w(){return V()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!s){g.next=5;break}return g.next=3,s==null?void 0:s();case 3:g.next=7;break;case 5:return g.next=7,a==null?void 0:a.validateFields();case 7:case"end":return g.stop()}},w)}));return function(){return N.apply(this,arguments)}}(),X=function(w){F&&(F==null||F(w))},Y=function(){var N=L()(V()().mark(function w(){return V()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",j==null?void 0:j(a==null?void 0:a.getFieldsValue()));case 1:case"end":return g.stop()}},w)}));return function(){return N.apply(this,arguments)}}(),J=function(w){if(i)i==null||i(w);else if(!$.bindEvent&&v!==null&&v!==void 0&&v.visible){var B;A(),v==null||(B=v.finished)===null||B===void 0||B.call(v,w)}},K=function(){var N=L()(V()().mark(function w(){var B;return V()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,S.next=3,I();case 3:return c(!0),S.next=6,Y();case 6:return B=S.sent,S.next=9,J(B);case 9:return S.abrupt("return",B);case 12:S.prev=12,S.t0=S.catch(0),X(S.t0);case 15:return S.prev=15,c(!1),S.finish(15);case 18:case"end":return S.stop()}},w,null,[[0,12,15,18]])}));return function(){return N.apply(this,arguments)}}();(0,l.useEffect)(function(){$.bindEvent&&!u&&$.bindEvent({onCancel:A,onBefore:I,onFinish:Y,onFinished:J,onFinishFailed:X})},[$.bindEvent,u]),(0,l.useImperativeHandle)(m,function(){return{reset:K}});var q=(0,d.jsx)(le.ZP,{onClick:A,disabled:O,children:h}),D=(0,d.jsx)(le.ZP,{onClick:K,type:"primary",loading:O,children:P}),k=T?(0,d.jsx)("div",{children:T({cancelDom:q,okDom:D},A,K)}):(0,d.jsxs)(oe.Z,{style:E,children:[q,D]});return $.type?u?k:(0,d.jsx)(l.Fragment,{}):k}),Te=Se,U=Te,je=p(97857),f=p.n(je),ve=(0,l.memo)(function(n){var m=n.visible,y=m===void 0?!1:m,T=n.initialValues,s=n.onFinished,j=n.open,F=n.close,i=n.children,a=n.opts,C=(0,l.useState)(!1),P=M()(C,2),e=P[0],h=P[1],u=(0,l.useMemo)(function(){return e?i:(0,d.jsx)("div",{style:{contentVisibility:y?"visible":"hidden"},children:i})},[e,y]);return(0,d.jsx)(se.Provider,{value:{initialValues:T,visible:y,opts:a,open:j,close:F,finished:s,hasPopupWindow:h},children:u})});ve.displayName="Popup";var Ce=ve,ce=(0,l.forwardRef)(function(n,m){var y=n.onFinished,T=n.onChange,s=n.items,j=s===void 0?[]:s,F=(0,l.useState)({}),i=M()(F,2),a=i[0],C=i[1];(0,l.useEffect)(function(){C(function(h){return j.forEach(function(u){h[u.key]={visible:!1,initialValues:void 0}}),f()({},h)})},[]);var P={open:function(u,E,W){if(a.hasOwnProperty(u))C(function(Z){return Z[u]={visible:!0,initialValues:E,opts:W},f()({},Z)}),T==null||T(u,a[u].visible);else throw new Error('Popups\u4E0B\u672A\u627E\u5230\u4E0E""'.concat(u,"'\u5173\u8054\u7684\u7EC4\u4EF6, \u8BF7\u68C0\u67E5!"))},close:function(u){C(function(E){return E[u].visible=!1,f()({},E)})}};(0,l.useImperativeHandle)(m,function(){return P});var e=(0,l.useMemo)(function(){return j.map(function(h){return(0,d.jsx)(Ce,f()(f()({},a[h.key]),{},{open:P.open,close:function(){P.close(h.key)},onFinished:function(E){y==null||y(h.key,E)},children:h.children}),h.key)})},[a]);return(0,d.jsx)(l.Fragment,{children:e})});ce.displayName="Popups";var we=ce,Ee=we,ke=p(13769),Ve=p.n(ke),We=p(85265),Be=p(64187),De=["width","mode","bordered","onClose","visible","submitter","className","children"];function Ne(n){var m=n.width,y=m===void 0?550:m,T=n.mode,s=T===void 0?"modal":T,j=n.bordered,F=j===void 0?!1:j,i=n.onClose,a=n.visible,C=n.submitter,P=n.className,e=n.children,h=Ve()(n,De),u=Q();(0,l.useEffect)(function(){u.hasPopupWindow&&u.hasPopupWindow(!0)},[u]);var E=function(){i?i():u.hasPopupWindow&&u.close()},W=f()({width:y,open:u.hasPopupWindow?u.visible:a},h);return C&&(s==="drawer"?W.extra=(0,d.jsx)(U,f()({},C)):W.footer=(0,d.jsx)(U,f()({},C))),s==="drawer"?(0,d.jsx)(We.Z,f()(f()({},W),{},{onClose:E,className:P,children:e})):(0,d.jsx)(Be.Z,f()(f()({footer:!1},W),{},{onCancel:E,className:"".concat(F?"popup-window-bordered":"popup-window"," ").concat(P),children:e}))}var Re=Ne,Ze=p(3363),Ie=p(67804);function Ke(n){var m=n.children,y=n.type,T=n.current,s=n.tabKey,j=n.bindEvent,F=n.values,i=n.initialValues,a=n.style,C=(0,l.useMemo)(function(){var P={};return P.contentVisibility=T===s?"visible":"hidden",(0,d.jsx)("div",{style:a||P,children:m})},[T,a]);return(0,d.jsx)(ue.Provider,{value:{values:F,initialValues:i,type:y,bindEvent:function(e){j(s,e)}},children:C})}var $e=Ke,G="solid 1px #f0f0f0";function fe(n){var m=n.activeKey,y=n.bodyStyle,T=n.type,s=T===void 0?"line":T,j=n.position,F=j===void 0?"top":j,i=n.items,a=n.render,C=n.fault,P=n.onChange,e=n.submitter,h=n.stepsProps,u=n.tabsProps,E=n.initialValues,W=n.bordered,Z=(0,l.useState)(0),O=M()(Z,2),c=O[0],v=O[1];(0,l.useEffect)(function(){i.length>0&&m&&v(i.findIndex(function(b){return b.key===m}))},[m,i]);var $=function(r){v(i.findIndex(function(t){return t.key===r}))},A=i.length-1,I=(0,l.useRef)({}),X=function(r,t){I.current[r]=t},Y=(0,l.useState)({}),J=M()(Y,2),K=J[0],q=J[1],D=(0,l.useRef)(!1),k=Q(),N=(0,l.useRef)(),w=function(r){setTimeout(function(){P==null||P(i[r].key,i[c].key)},50)},B=function(){if(e!=null&&e.onFinished){var r;(r=e.onFinished)===null||r===void 0||r.call(e,K,i[c].key)}else if(k){var t;k.close(),(t=k.finished)===null||t===void 0||t.call(k,K)}};(0,l.useEffect)(function(){if(k&&k.visible){var b=0;m&&(b=i.findIndex(function(r){return r.key===m})),v(b),D.current=!1}},[k]);var g=(0,d.jsx)(U,{ref:N,insideStepTabs:!0,onCancel:function(){if(s==="steps")v(function(t){return t-1}),D.current&&(D.current=!1),w(c+1);else if(e!=null&&e.onCancel){var r;(r=e.onCancel)===null||r===void 0||r.call(e,i[c].key)}else k==null||k.close()},onBefore:L()(V()().mark(function b(){var r,t,x;return V()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!D.current){o.next=4;break}return o.abrupt("return",e==null||(r=e.onBefore)===null||r===void 0?void 0:r.call(e,i[c].key));case 4:return o.next=6,(t=I.current[c])===null||t===void 0?void 0:t.onBefore();case 6:if(s==="steps"){o.next=9;break}return o.next=9,e==null||(x=e.onBefore)===null||x===void 0?void 0:x.call(e,i[c].key);case 9:case"end":return o.stop()}},b)})),onFinish:L()(V()().mark(function b(){var r,t,x;return V()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!D.current){o.next=4;break}return o.abrupt("return",e==null||(r=e.onFinish)===null||r===void 0?void 0:r.call(e,K,i[c].key));case 4:return o.next=6,(t=I.current[c])===null||t===void 0?void 0:t.onFinish();case 6:if(x=o.sent,!(s!=="steps"&&e!==null&&e!==void 0&&e.onFinish)){o.next=11;break}return o.next=10,e.onFinish(x,i[c].key);case 10:x=o.sent;case 11:return o.abrupt("return",x);case 12:case"end":return o.stop()}},b)})),onFinished:function(r){if(D.current)B();else{var t,x;if(q(function(o){return o[i[c].key]=r,o}),(t=I.current[c])===null||t===void 0||(x=t.onFinished)===null||x===void 0||x.call(t,r),s==="steps")if(c<A)v(function(o){return o+1}),w(c-1);else{var R;D.current=!0,(R=N.current)===null||R===void 0||R.reset()}else B()}},onFinishFailed:function(){var b=L()(V()().mark(function r(t){var x,R,o;return V()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!D.current){z.next=4;break}e==null||(x=e.onFinishFailed)===null||x===void 0||x.call(e,t,i[c].key),z.next=8;break;case 4:if((R=I.current[c])===null||R===void 0||R.onFinishFailed(t),s==="steps"){z.next=8;break}return z.next=8,e==null||(o=e.onFinishFailed)===null||o===void 0?void 0:o.call(e,t,i[c].key);case 8:case"end":return z.stop()}},r)}));return function(r){return b.apply(this,arguments)}}(),cancelText:s==="steps"?(e==null?void 0:e.prevText)||"\u4E0A\u4E00\u6B65":(e==null?void 0:e.cancelText)||"\u53D6\u6D88",confirmText:s==="steps"&&c<A?(e==null?void 0:e.nextText)||"\u4E0B\u4E00\u6B65":(e==null?void 0:e.confirmText)||"\u786E\u5B9A",render:function(r){var t=r.okDom,x=r.cancelDom;return s==="steps"&&(c===0||C)?t:(0,d.jsxs)(oe.Z,{children:[x,t]})}}),S=F==="left"||F==="right",ne=f()({padding:"16px 24px",minWidth:0,maxWidth:"100%",boxSizing:"border-box",flex:1},y),ie=i.map(function(b,r){var t={type:s,tabKey:r,current:c,bindEvent:X,values:K,initialValues:E};return s!=="steps"&&(t.style={}),(0,d.jsx)($e,f()(f()({},t),{},{children:b.children}),b.key)});if(s==="steps"){var _={minWidth:0,maxWidth:"100%",boxSizing:"border-box",display:"flex",flexDirection:"column",flex:1},he="horizontal",H={boxSizing:"border-box",padding:"16px 24px"},be="default";S&&(_.flexDirection="row",he="vertical",H.width="fit-content",H.height="fit-content",be="small",H.padding="16px 24px"),h!=null&&h.style&&(H=f()(f()({},h==null?void 0:h.style),H));var re=(0,l.createElement)(Ze.Z,f()(f()({size:be},h),{},{key:"steps",items:i,direction:he,style:H,current:c})),ee=[];if(S&&W){var te={};F==="left"?te.borderRight=G:te.borderLeft=G,re=(0,d.jsx)("div",{style:te,children:re}),ne.padding="16px",_.border=G}else W&&(_.border=G);var me=(0,d.jsxs)("div",{style:ne,children:[ie,!a&&(0,d.jsx)("div",{style:{marginTop:"16px"},children:g})]},"content");ee.push(re),F==="right"||F==="bottom"?ee.unshift(me):ee.push(me);var pe=(0,d.jsx)("div",{style:_,children:ee});return a?a(pe,g):pe}var Me=i.map(function(b,r){var t=f()({},ne),x=a?(0,d.jsx)("div",{style:t,children:ie[r]}):(0,d.jsxs)("div",{style:t,children:[ie[r],(0,d.jsx)("div",{style:{marginTop:"16px"},children:g})]});return{key:b.key,label:b.title,children:x}}),ye={};W&&(ye.border=G);var Fe=(0,d.jsx)(Ie.Z,f()(f()({},u),{},{onChange:$,style:ye,type:s,tabPosition:F,items:Me,activeKey:i[c].key,className:"re-step-tabs-".concat(F)}));return a?a(Fe,g):Fe}fe.displayName="StepTabs";var Ae=fe;function ze(n){var m={};return Object.keys(n).forEach(function(y){m=f()(f()({},m),n[y])}),m}var Le=Ae,He=Ee}}]);
